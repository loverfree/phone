<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.newer.phone.dao.ProductMapper">
  	 <resultMap type="com.newer.phone.pojo.Product" id="product-result">
  		<id property="p_id" column="p_id"/>
  		<result property="p_name" column="p_name"/>
  		<result property="p_sale" column="p_sale"/>
  		<result property="p_info" column="p_info"/>
  		<result property="p_price" column="p_price"/>
  		<result property="p_stock" column="p_stock"/>
  		<!-- 关联多个图片 -->
  		<collection property="images" ofType="com.newer.phone.pojo.Image" resultMap="image-result"></collection>
  	</resultMap>
  	
  	<resultMap type="com.newer.phone.pojo.Image" id="image-result">
  		<id property="i_id" column="i_id"/>
  		<result property="i_path" column="i_path"/>
  		<association property="product" column="p_id" javaType="com.newer.phone.pojo.Product" resultMap="product-result"/>
  	</resultMap>
  	

  	
  	<!-- 查询所有商品 -->
  	<select id="findAllProduct" resultMap="product-result">
  		select p.p_name,p.p_info,p.p_price,p.p_sale,i.* from product p,image i where p.p_id = i.p_id
  	</select>
  	
  	<!-- 根据商品类别查询商品 -->
  	<select id="findByBrand" resultMap="product-result" parameterType="int">
  		select p.p_name,p.p_info,p.p_sale,i.i_path from product p,image i where p.b_id = #{b_id} and p.p_id = i.p_id 
  	</select>
  	
  	<!-- 根据商品id去查询单个商品详情 -->
  	<select id="findById" parameterType="int" resultMap="product-result">
  	    select * from product where p_status=1 and p_id=#{p_id}
  	</select>
  	
  	
  	
  	
  	
  	
  </mapper>